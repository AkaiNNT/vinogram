<section>
	<div class="row">
		<div class="col-lg-8 offset-lg-2 col-10 offset-1 ">
			<div class="card">
				<div class="card-body form-create-post">
					<div class="row">
						<div class="col-sm-2 col-md-2 col-lg-1 col-2">
							<div class="thumbnail profile-post">
								<%= image_tag current_user.avatar.url, :alt => "rss feed", :class => "img-thumbnail img-fluid rounded-circle rounded "%>
							</div>
			      </div>
						<div class="col-sm-10 col-md-10 col-lg-11 col-10">
							<%= simple_form_for @post do |f| %>
							  <div class="form-inputs">
							    <%= f.input :content, label: false, required: true, autofocus: true, placeholder: "What's on your mind today?" %>
							  </div>
							  <div class="form-actions">
							  	<div class="row" id="add-cocoon">

										<div id="preview" class="d-none"><img src=""></div>

									</div>
									<div class="eventUploadVideo">
								  	<%= f.file_field :attachment,id: "inputVideo" , class: "d-none" %>
									</div>
									<div class="links">
								    <%= link_to_add_association '<button type="button" class="btn btn-default"><i class="fa fa-camera"></i></button>'.html_safe, f, :pictures, id: 'link-add-pic' %>

								    <button type="button" class="btn btn-default" onClick="addVideo()" ><i class="fa fa-video-camera"></i><label class="text-right"></label></button>
								  	<%= f.button :submit, "Post" , :class => "btn btn-outline-primary btn-post"%>
								  </div>
							  </div>
							<% end %>
							<% flash.each do |key, value| %>
				        <div class="row">
				          <div class="alert alert-<%= key %>">
				            <%= value %>
				          </div>
				        </div>
				      <% end %>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<script type="text/javascript">
  $(document).ready(function() {
    $("#link-add-pic").
      data("association-insertion-method", 'append').
      data("association-insertion-node", '#add-cocoon');
  });

  function addVideo() {
	  $("#inputVideo").click()
	}

	function readURL(input){
		if (input.files && input.files[0]) {
			var reader = new FileReader();
			reader.onload = function (e){
				console.log(e.target)
				$('#preview img').attr('src', e.target.result).css('width','150px')
          .css('height', '100px');;
			};
			reader.readAsDataURL(input.files[0]);
		}
	}
	$('.eventUploadVideo').on('change','input[type="file"]',function(){
		$('#preview').removeClass('d-none');
		readURL(this);
	});
</script>
